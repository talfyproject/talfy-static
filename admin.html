<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin ‚Äì Talfy</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 30px; background: #f7f7f7; color: #333; }
    h1 { color: #2c7744; }
    h2 { margin-top: 40px; color: #555; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #2c7744; color: white; }
    pre { background: #eee; padding: 10px; }
  </style>
</head>
<body>
  <h1>Admin Panel ‚Äì Talfy</h1>
  <p><strong>Accesso riservato</strong></p>

  <div id="content">Loading...</div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const key = urlParams.get('admin');

    if (key !== "FEDE21") {
      document.getElementById("content").innerHTML = "<p><strong>Accesso negato</strong></p>";
    } else {
      fetch("/admin-data")
        .then(res => res.json())
        .then(data => {
          let html = "";

          html += "<h2>üë§ Utenti registrati</h2>";
          html += "<table><tr><th>ID</th><th>Email</th><th>Tipo</th></tr>";
          data.users.forEach(u => {
            html += `<tr><td>${u.id}</td><td>${u.email}</td><td>${u.type}</td></tr>`;
          });
          html += "</table>";

          html += "<h2>üìÑ Profili Candidati</h2>";
          html += "<table><tr><th>ID</th><th>User ID</th><th>Nome</th><th>Job</th><th>Anni</th></tr>";
          data.candidates.forEach(c => {
            html += `<tr><td>${c.id}</td><td>${c.user_id}</td><td>${c.name}</td><td>${c.job}</td><td>${c.years}</td></tr>`;
          });
          html += "</table>";

          html += "<h2>üè¢ Profili Aziende</h2>";
          html += "<table><tr><th>ID</th><th>User ID</th><th>Nome</th><th>Settore</th><th>Sede</th></tr>";
          data.companies.forEach(c => {
            html += `<tr><td>${c.id}</td><td>${c.user_id}</td><td>${c.name}</td><td>${c.sector}</td><td>${c.hq}</td></tr>`;
          });
          html += "</table>";

          document.getElementById("content").innerHTML = html;
        })
        .catch(err => {
          document.getElementById("content").innerHTML = "<p>Errore nel caricamento dati</p><pre>" + err + "</pre>";
        });
    }
  </script>
</body>
</html>
